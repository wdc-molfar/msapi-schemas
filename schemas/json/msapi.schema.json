{
 "description": "Validation schema for MSAPI Specification 1.0.X.",
 "type": "object",
 "required": [
  "msapi",
  "metadata"
 ],
 "properties": {
  "msapi": {
   "$ref": "#/definitions/Version"
  },
  "metadata": {
   "type": "object",
   "required": [
    "id",
    "title"
   ],
   "properties": {
    "id": {
     "type": "string"
    },
    "title": {
     "type": "string"
    },
    "description": {
     "type": "string"
    },
    "contact": {
     "type": "object",
     "properties": {
      "name": {
       "type": "string"
      },
      "url": {
       "type": "string",
       "format": "uri-reference"
      },
      "email": {
       "type": "string",
       "format": "email"
      }
     },
     "patternProperties": {
      "^x-": {}
     },
     "additionalProperties": false
    },
    "license": {
     "type": "object",
     "required": [
      "name"
     ],
     "properties": {
      "name": {
       "type": "string"
      },
      "url": {
       "type": "string",
       "format": "uri-reference"
      }
     },
     "patternProperties": {
      "^x-": {}
     },
     "additionalProperties": false
    },
    "repo": {
     "type": "string",
     "format": "uri-reference"
    }
   },
   "patternProperties": {
    "^x-": {}
   },
   "additionalProperties": true,
   "definitions": {
    "Contact": {
     "type": "object",
     "properties": {
      "name": {
       "type": "string"
      },
      "url": {
       "type": "string",
       "format": "uri-reference"
      },
      "email": {
       "type": "string",
       "format": "email"
      }
     },
     "patternProperties": {
      "^x-": {}
     },
     "additionalProperties": false
    },
    "License": {
     "type": "object",
     "required": [
      "name"
     ],
     "properties": {
      "name": {
       "type": "string"
      },
      "url": {
       "type": "string",
       "format": "uri-reference"
      }
     },
     "patternProperties": {
      "^x-": {}
     },
     "additionalProperties": false
    }
   }
  },
  "components": {
   "type": "object",
   "properties": {
    "exchanges": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "type": "object",
         "properties": {
          "name": {
           "type": "string"
          },
          "mode": {
           "enum": [
            "fanout",
            "topic",
            "direct"
           ],
           "default": "fanout"
          },
          "options": {
           "type": "object",
           "properties": {
            "durable": {
             "type": "boolean",
             "default": true
            },
            "autoDelete": {
             "type": "boolean",
             "default": false
            }
           }
          }
         }
        },
        {
         "$ref": "#/definitions/Reference"
        }
       ]
      }
     }
    },
    "queues": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "$ref": "#/definitions/Reference"
        },
        {
         "type": "object",
         "properties": {
          "name": {
           "type": "string"
          },
          "exchange": {
           "oneOf": [
            {
             "$ref": "#/definitions/Reference"
            },
            {
             "type": "object",
             "properties": {
              "name": {
               "type": "string"
              },
              "mode": {
               "enum": [
                "fanout",
                "topic",
                "direct"
               ],
               "default": "fanout"
              },
              "options": {
               "type": "object",
               "properties": {
                "durable": {
                 "type": "boolean",
                 "default": true
                },
                "autoDelete": {
                 "type": "boolean",
                 "default": false
                }
               }
              }
             }
            }
           ]
          },
          "options": {
           "type": "object",
           "properties": {
            "noAck": {
             "type": "boolean",
             "default": false
            },
            "exclusive": {
             "type": "boolean",
             "default": false
            },
            "durable": {
             "type": "boolean",
             "default": true
            },
            "autoDelete": {
             "type": "boolean",
             "default": false
            },
            "prefetch": {
             "type": "number",
             "default": 1
            }
           }
          }
         }
        }
       ]
      }
     }
    },
    "schemas": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "$ref": "#/definitions/Reference"
        },
        {
         "$ref": "#/definitions/Schema"
        }
       ]
      }
     }
    },
    "messages": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "$ref": "#/definitions/Reference"
        }
       ]
      }
     }
    },
    "consumes": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "$ref": "#/definitions/Reference"
        }
       ]
      }
     }
    },
    "produces": {
     "type": "object",
     "patternProperties": {
      "^[a-zA-Z0-9\\.\\-_]+$": {
       "oneOf": [
        {
         "$ref": "#/definitions/Reference"
        }
       ]
      }
     }
    },
    "settings": {
     "type": "object"
    }
   }
  },
  "service": {
   "type": "object",
   "properties": {
    "config": {
     "type": "object"
    },
    "consume": {
     "$ref": "#/definitions/Extensible"
    },
    "produce": {
     "$ref": "#/definitions/Extensible"
    }
   }
  },
  "workflow": {
   "type": "array",
   "items": {
    "type": "object",
    "required": [
     "instance"
    ],
    "patternProperties": {
     "^instance$": {
      "oneOf": [
       {
        "type": "object",
        "required": [
         "$ref"
        ],
        "properties": {
         "$ref": {
          "type": "string",
          "format": "uri-reference"
         }
        }
       }
      ]
     },
     "^name$": {
      "type": "string"
     },
     "^configuredBy$": {
      "type": "object"
     }
    }
   }
  }
 },
 "definitions": {
  "Reference": {
   "type": "object",
   "required": [
    "$ref"
   ],
   "properties": {
    "$ref": {
     "type": "string",
     "format": "uri-reference"
    }
   }
  },
  "Version": {
   "type": "string",
   "pattern": "^1\\.0\\.\\d(-.+)?$"
  },
  "Schema": {
   "type": "object",
   "properties": {
    "title": {
     "type": "string"
    },
    "multipleOf": {
     "type": "number",
     "minimum": 0
    },
    "maximum": {
     "type": "number"
    },
    "exclusiveMaximum": {
     "type": "boolean",
     "default": false
    },
    "minimum": {
     "type": "number"
    },
    "exclusiveMinimum": {
     "type": "boolean",
     "default": false
    },
    "maxLength": {
     "type": "integer",
     "minimum": 0
    },
    "minLength": {
     "type": "integer",
     "minimum": 0,
     "default": 0
    },
    "pattern": {
     "type": "string",
     "format": "regex"
    },
    "maxItems": {
     "type": "integer",
     "minimum": 0
    },
    "minItems": {
     "type": "integer",
     "minimum": 0,
     "default": 0
    },
    "uniqueItems": {
     "type": "boolean",
     "default": false
    },
    "maxProperties": {
     "type": "integer",
     "minimum": 0
    },
    "minProperties": {
     "type": "integer",
     "minimum": 0,
     "default": 0
    },
    "required": {
     "type": "array",
     "items": {
      "type": "string"
     },
     "minItems": 1,
     "uniqueItems": true
    },
    "enum": {
     "type": "array",
     "items": {},
     "minItems": 1,
     "uniqueItems": false
    },
    "type": {
     "type": "string",
     "enum": [
      "array",
      "boolean",
      "integer",
      "number",
      "object",
      "string"
     ]
    },
    "not": {
     "oneOf": [
      {
       "$ref": "#/definitions/Schema"
      },
      {
       "$ref": "#/definitions/Reference"
      }
     ]
    },
    "allOf": {
     "type": "array",
     "items": {
      "oneOf": [
       {
        "$ref": "#/definitions/Schema"
       },
       {
        "$ref": "#/definitions/Reference"
       }
      ]
     }
    },
    "oneOf": {
     "type": "array",
     "items": {
      "oneOf": [
       {
        "$ref": "#/definitions/Schema"
       },
       {
        "$ref": "#/definitions/Reference"
       }
      ]
     }
    },
    "anyOf": {
     "type": "array",
     "items": {
      "oneOf": [
       {
        "$ref": "#/definitions/Schema"
       },
       {
        "$ref": "#/definitions/Reference"
       }
      ]
     }
    },
    "items": {
     "oneOf": [
      {
       "$ref": "#/definitions/Schema"
      },
      {
       "$ref": "#/definitions/Reference"
      }
     ]
    },
    "properties": {
     "type": "object",
     "additionalProperties": {
      "oneOf": [
       {
        "$ref": "#/definitions/Schema"
       },
       {
        "$ref": "#/definitions/Reference"
       }
      ]
     }
    },
    "additionalProperties": {
     "oneOf": [
      {
       "$ref": "#/definitions/Schema"
      },
      {
       "$ref": "#/definitions/Reference"
      },
      {
       "type": "boolean"
      }
     ],
     "default": true
    },
    "description": {
     "type": "string"
    },
    "format": {
     "type": "string"
    },
    "default": {},
    "nullable": {
     "type": "boolean",
     "default": false
    },
    "discriminator": {
     "$ref": "#/definitions/Discriminator"
    },
    "readOnly": {
     "type": "boolean",
     "default": false
    },
    "writeOnly": {
     "type": "boolean",
     "default": false
    },
    "example": {},
    "externalDocs": {
     "$ref": "#/definitions/ExternalDocumentation"
    },
    "deprecated": {
     "type": "boolean",
     "default": false
    },
    "xml": {
     "$ref": "#/definitions/XML"
    }
   },
   "patternProperties": {
    "^x-": {}
   },
   "additionalProperties": false
  },
  "ExternalDocumentation": {
   "type": "object",
   "required": [
    "url"
   ],
   "properties": {
    "description": {
     "type": "string"
    },
    "url": {
     "type": "string",
     "format": "uri-reference"
    }
   },
   "patternProperties": {
    "^x-": {}
   },
   "additionalProperties": false
  },
  "Discriminator": {
   "type": "object",
   "required": [
    "propertyName"
   ],
   "properties": {
    "propertyName": {
     "type": "string"
    },
    "mapping": {
     "type": "object",
     "additionalProperties": {
      "type": "string"
     }
    }
   }
  },
  "XML": {
   "type": "object",
   "properties": {
    "name": {
     "type": "string"
    },
    "namespace": {
     "type": "string",
     "format": "uri"
    },
    "prefix": {
     "type": "string"
    },
    "attribute": {
     "type": "boolean",
     "default": false
    },
    "wrapped": {
     "type": "boolean",
     "default": false
    }
   },
   "patternProperties": {
    "^x-": {}
   },
   "additionalProperties": false
  },
  "Extensible": {
   "type": "object",
   "required": [
    "def"
   ],
   "patternProperties": {
    "^def$": {
     "$ref": "#/definitions/Reference"
    },
    "^extendedBy": {
     "type": "array",
     "items": {
      "$ref": "#/definitions/Reference"
     }
    }
   }
  }
 }
}